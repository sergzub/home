#!/bin/bash -eu

readonly SELF_PATH="$(readlink -e "$(dirname "$0")")"

readonly INCLUDE_SHH_PATH="${SELF_PATH}/include"
. "${SELF_PATH}/include-shh"

Include 'colors'
Include 'utils'

Main()
{
    if [ -f '/var/run/reboot-required' ]; then
        if [ -f '/var/run/reboot-required.pkgs' ]; then
            echo
            echo '======= Packages require reboot =========='
            cat '/var/run/reboot-required.pkgs'
            echo '=========================================='
        fi
        local msg="$(cat /var/run/reboot-required)"
        local cols=$((${#msg} + 2))
        echo "${MAGENTA}${TEXT_BOLD}"
        printf '╔'; Repeat ${cols} '═'; printf '╗\n'
        printf '║ %s ║\n' "${msg}"
        printf '╚'; Repeat ${cols} '═'; printf '╝\n'
        echo "${SGR0}"
        exit 0
    else
        echo "┌────────────────────┐"
        echo "│ No need to restart │"
        echo "└────────────────────┘"
        exit 1
    fi
}

Main "$@"
